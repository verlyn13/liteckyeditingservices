---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import FeaturedTestimonial from '../components/FeaturedTestimonial.astro';
import { getCollection } from 'astro:content';

const testimonials = (await getCollection('testimonials')).sort((a, b) =>
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<BaseLayout title="Testimonials" description="Real outcomes from real scholars">
  <script type="application/ld+json" is:inline>{JSON.stringify({
    '@context': 'https://schema.org',
    '@type': 'TestimonialsPage',
    'about': {
      '@type': 'ProfessionalService',
      'name': 'Litecky Editing Services'
    },
    'review': [
      {
        '@type': 'Review',
        'reviewRating': {
          '@type': 'Rating',
          'ratingValue': '5'
        },
        'author': {
          '@type': 'Person',
          'name': 'Doctoral Candidate',
          'jobTitle': 'Education'
        },
        'reviewBody': 'They transformed my dissertation into a polished, publication-ready document.'
      },
      {
        '@type': 'Review',
        'reviewRating': {
          '@type': 'Rating',
          'ratingValue': '5'
        },
        'author': {
          '@type': 'Person',
          'name': 'PhD Student',
          'jobTitle': 'Psychology'
        },
        'reviewBody': 'Clear edits and a respectful, confidence-building memo. Exactly what I needed.'
      }
    ]
  })}</script>
  <Header currentPath={Astro.url.pathname} />
  <main id="main" class="section">
    <div class="container">
      <h1 class="text-3xl md:text-4xl font-bold text-primary-navy">Testimonials</h1>
      {testimonials.map((t) => (
        <FeaturedTestimonial quote={t.data.quote} author={t.data.author} role={t.data.role} />
      ))}
    </div>
  </main>
</BaseLayout>
